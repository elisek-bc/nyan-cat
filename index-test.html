<!DOCTYPE html>

<html lang=en>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        
        <title>Nyan-Cat Javascript Exercise</title>
        <link href="https://fonts.googleapis.com/css?family=Teko:400,700" rel="stylesheet">
        <link rel="stylesheet" href="styles.css">
    </head>

    <body>

    <!--this is the button-->
        <button id="meowbutton">Meow!</button>

    <!--Javascript starts here-->
        <script>
        
    // creating variable button
        var meow = document.getElementById('meowbutton');

        /*====================================================*/
    
        function createCats (){
            console.log('create cats start');
            var numCats = 20;

            for (var i = 0; i<numCats; i++) {
                var nyanCat = document.createElement('img');
                nyanCat.src = 'nyancat.gif';

    // random positioning start
                var x = Math.floor(Math.random()*parseInt(document.body.clientWidth));
                nyanCat.style.left = x + 'px';
                nyanCat.style.top = '-100px'; 

    // styling and placing
                nyanCat.style.height = '60px';
                nyanCat.style.transform = 'rotate(45deg)';
                document.body.appendChild(nyanCat);
                nyanCat.classList.add('nyanCat');
            }
            var cats = document.body.querySelectorAll('.nyanCat');

    // working animation
        cats.forEach(function(cat){
            setTimeout(function(){
                var x = Math.floor(Math.random()*parseInt(document.body.clientWidth));
                var y = parseInt(window.innerHeight)+200;
                cat.style.left = x + 'px';
                cat.style.top = y + 'px';
    // randomize speed here
                var speed = Math.floor(Math.random()*10)+3;
                cat.style.transition = speed + 's';
    // randomize rotation here
                var dontFallOnYourFace = Math.floor(Math.random()*360)
                cat.style.transform = "rotate(" + dontFallOnYourFace + "deg)";
            },100);
        });   
        }

    // 3 steps: on what, when, function?    
        meow.addEventListener('click', everything);

    // specifying function on click and creating cat var
        function everything() {
            createCats();
            var cats = document.body.querySelectorAll('.nyanCat');


    // specifying background style + deleting button
            if (cats !=null) {
                document.body.style.backgroundImage = "url('nyancatbackground.gif')";
                document.body.style.backgroundSize = '30vh';
                
                var meow = document.getElementById('meowbutton');
                meow.parentNode.removeChild(meow);

                var nyanAudio = document.createElement('audio');
                nyanAudio.src = 'nyancatsound.mp3';
                document.body.appendChild(nyanAudio);
                nyanAudio.play();
    // audio not working yet!!! due to: Uncaught (in promise) DOMException
            }

       
      
    // loops animation every 3 seconds: does not work! Zal enkel elke 3 seconden 20 katten creeren maar niet animeren..? 
        var loopCats = window.setInterval(createCats, 1000);
        console.log(loopCats);
    
    // stops animation after 10sec: does not work!            
        //setTimeout(clearInterval(loopCats),20000);

        } 
/*========================END OF EVERYTHING=========================*/   



        console.log();

        </script>

    </body> 

</html>