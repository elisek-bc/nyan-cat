<!DOCTYPE html>

<html lang=en>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        
        <title>Nyan-Cat Javascript Exercise</title>
        <link href="https://fonts.googleapis.com/css?family=Teko:400,700" rel="stylesheet">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
    <!--this is the button-->
        <button id="meowbutton">Meow!</button>
    <!--Javascript starts here-->
        <script>     
    // creating variable button
        var meow = document.getElementById('meowbutton');

    /*====================== ONE CAT IS ALL IT TAKES ==============================*/
    
        function createCat (){
            console.log('create cats start');
            var numCats = 20;

            for (var i = 0; i<numCats; i++) {
                var nyanCat = document.createElement('img');
                nyanCat.src = 'nyancat.gif';

    // random positioning start
                var x = Math.floor(Math.random()*parseInt(document.body.clientWidth));
                nyanCat.style.left = x + 'px';
                nyanCat.style.top = '-100px'; 

    // styling and placing
                nyanCat.style.height = '60px';
                nyanCat.style.transform = 'rotate(45deg)';
                document.body.appendChild(nyanCat);
                nyanCat.classList.add('nyanCat');

                setTimeout(function(){
                    var x = Math.floor(Math.random()*parseInt(document.body.clientWidth));
                    var y = parseInt(window.innerHeight)+200;
                    nyanCat.style.left = x + 'px';
                    nyanCat.style.top = y + 'px';

    // randomize speed here
                    var speed = Math.floor(Math.random()*10)+3;
                    nyanCat.style.transition = speed + 's';

    // randomize rotation here
                    var dontFallOnYourFace = Math.floor(Math.random()*360)
                    nyanCat.style.transform = "rotate(" + dontFallOnYourFace + "deg)";
                },100);
                };
            }

    // 3 steps: on what, when, function?    
        meow.addEventListener('click', everything);

    // specifying function on click and creating cat var
        function everything() {
            createCat();

    // specifying background style + deleting button + playing audio
            if (createCat) {
                document.body.style.backgroundImage = "url('nyancatbackground.gif')";
                document.body.style.backgroundSize = '30vh';
                
                var meow = document.getElementById('meowbutton');
                meow.parentNode.removeChild(meow);

                var nyanAudio = document.createElement('audio');
                nyanAudio.src = 'nyancatsound.mp3';
                document.body.appendChild(nyanAudio);
                nyanAudio.play();
    // audio not working yet!!! due to: Uncaught (in promise) DOMException
            }

    // loops animation every 3 seconds: working
        var loopCats = setInterval(createCat, 1000);

    // and stopping after 10 seconds: not working!!!!   
        var intervalStop = clearInterval(loopCats);
        setTimeout(intervalStop,10000);

    // delete cats after they passed end of screen
              
    }
/*========================END OF EVERYTHING=========================*/   
        </script>
    </body> 
</html>